"use strict";
// assets/asset.model.ts
// Asset MongoDB schema and model
Object.defineProperty(exports, "__esModule", { value: true });
exports.Asset = void 0;
const mongoose_1 = require("mongoose");
const assetSchema = new mongoose_1.Schema({
    ownerId: {
        type: mongoose_1.Schema.Types.ObjectId,
        ref: 'User',
        required: [true, 'Owner is required'],
        index: true,
    },
    name: {
        type: String,
        required: [true, 'Asset name is required'],
        trim: true,
    },
    type: {
        type: String,
        enum: ['image', 'video', 'file'],
        required: [true, 'Asset type is required'],
    },
    s3Bucket: {
        type: String,
        required: [true, 'S3 bucket is required'],
    },
    s3Key: {
        type: String,
        required: [true, 'S3 key is required'],
        unique: true,
    },
    cloudfrontUrl: {
        type: String,
        required: [true, 'CloudFront URL is required'],
    },
    sizeBytes: {
        type: Number,
        required: [true, 'File size is required'],
    },
    metadata: {
        width: Number,
        height: Number,
        format: String,
    },
    isDeleted: {
        type: Boolean,
        default: false,
    },
}, {
    timestamps: true,
});
// Indexes for efficient queries
assetSchema.index({ ownerId: 1, isDeleted: 1 });
assetSchema.index({ s3Key: 1 });
assetSchema.index({ createdAt: -1 });
exports.Asset = mongoose_1.default.model('Asset', assetSchema);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZXQubW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJhc3NldC5tb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsd0JBQXdCO0FBQ3hCLGlDQUFpQzs7O0FBRWpDLHVDQUFzRDtBQW9CdEQsTUFBTSxXQUFXLEdBQUcsSUFBSSxpQkFBTSxDQUM1QjtJQUNFLE9BQU8sRUFBRTtRQUNQLElBQUksRUFBRSxpQkFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRO1FBQzNCLEdBQUcsRUFBRSxNQUFNO1FBQ1gsUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLG1CQUFtQixDQUFDO1FBQ3JDLEtBQUssRUFBRSxJQUFJO0tBQ1o7SUFDRCxJQUFJLEVBQUU7UUFDSixJQUFJLEVBQUUsTUFBTTtRQUNaLFFBQVEsRUFBRSxDQUFDLElBQUksRUFBRSx3QkFBd0IsQ0FBQztRQUMxQyxJQUFJLEVBQUUsSUFBSTtLQUNYO0lBQ0QsSUFBSSxFQUFFO1FBQ0osSUFBSSxFQUFFLE1BQU07UUFDWixJQUFJLEVBQUUsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBQztRQUNoQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLEVBQUUsd0JBQXdCLENBQUM7S0FDM0M7SUFDRCxRQUFRLEVBQUU7UUFDUixJQUFJLEVBQUUsTUFBTTtRQUNaLFFBQVEsRUFBRSxDQUFDLElBQUksRUFBRSx1QkFBdUIsQ0FBQztLQUMxQztJQUNELEtBQUssRUFBRTtRQUNMLElBQUksRUFBRSxNQUFNO1FBQ1osUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLG9CQUFvQixDQUFDO1FBQ3RDLE1BQU0sRUFBRSxJQUFJO0tBQ2I7SUFDRCxhQUFhLEVBQUU7UUFDYixJQUFJLEVBQUUsTUFBTTtRQUNaLFFBQVEsRUFBRSxDQUFDLElBQUksRUFBRSw0QkFBNEIsQ0FBQztLQUMvQztJQUNELFNBQVMsRUFBRTtRQUNULElBQUksRUFBRSxNQUFNO1FBQ1osUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLHVCQUF1QixDQUFDO0tBQzFDO0lBQ0QsUUFBUSxFQUFFO1FBQ1IsS0FBSyxFQUFFLE1BQU07UUFDYixNQUFNLEVBQUUsTUFBTTtRQUNkLE1BQU0sRUFBRSxNQUFNO0tBQ2Y7SUFDRCxTQUFTLEVBQUU7UUFDVCxJQUFJLEVBQUUsT0FBTztRQUNiLE9BQU8sRUFBRSxLQUFLO0tBQ2Y7Q0FDRixFQUNEO0lBQ0UsVUFBVSxFQUFFLElBQUk7Q0FDakIsQ0FDRixDQUFDO0FBRUYsZ0NBQWdDO0FBQ2hDLFdBQVcsQ0FBQyxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ2hELFdBQVcsQ0FBQyxLQUFLLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNoQyxXQUFXLENBQUMsS0FBSyxDQUFDLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUV4QixRQUFBLEtBQUssR0FBRyxrQkFBUSxDQUFDLEtBQUssQ0FBUyxPQUFPLEVBQUUsV0FBVyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhc3NldHMvYXNzZXQubW9kZWwudHNcclxuLy8gQXNzZXQgTW9uZ29EQiBzY2hlbWEgYW5kIG1vZGVsXHJcblxyXG5pbXBvcnQgbW9uZ29vc2UsIHsgRG9jdW1lbnQsIFNjaGVtYSB9IGZyb20gJ21vbmdvb3NlJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUFzc2V0IGV4dGVuZHMgRG9jdW1lbnQge1xyXG4gIG93bmVySWQ6IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICB0eXBlOiAnaW1hZ2UnIHwgJ3ZpZGVvJyB8ICdmaWxlJztcclxuICBzM0J1Y2tldDogc3RyaW5nO1xyXG4gIHMzS2V5OiBzdHJpbmc7XHJcbiAgY2xvdWRmcm9udFVybDogc3RyaW5nO1xyXG4gIHNpemVCeXRlczogbnVtYmVyO1xyXG4gIG1ldGFkYXRhPzoge1xyXG4gICAgd2lkdGg/OiBudW1iZXI7XHJcbiAgICBoZWlnaHQ/OiBudW1iZXI7XHJcbiAgICBmb3JtYXQ/OiBzdHJpbmc7XHJcbiAgfTtcclxuICBpc0RlbGV0ZWQ6IGJvb2xlYW47XHJcbiAgY3JlYXRlZEF0OiBEYXRlO1xyXG4gIHVwZGF0ZWRBdDogRGF0ZTtcclxufVxyXG5cclxuY29uc3QgYXNzZXRTY2hlbWEgPSBuZXcgU2NoZW1hPElBc3NldD4oXHJcbiAge1xyXG4gICAgb3duZXJJZDoge1xyXG4gICAgICB0eXBlOiBTY2hlbWEuVHlwZXMuT2JqZWN0SWQsXHJcbiAgICAgIHJlZjogJ1VzZXInLFxyXG4gICAgICByZXF1aXJlZDogW3RydWUsICdPd25lciBpcyByZXF1aXJlZCddLFxyXG4gICAgICBpbmRleDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBuYW1lOiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IFt0cnVlLCAnQXNzZXQgbmFtZSBpcyByZXF1aXJlZCddLFxyXG4gICAgICB0cmltOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIHR5cGU6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICBlbnVtOiBbJ2ltYWdlJywgJ3ZpZGVvJywgJ2ZpbGUnXSxcclxuICAgICAgcmVxdWlyZWQ6IFt0cnVlLCAnQXNzZXQgdHlwZSBpcyByZXF1aXJlZCddLFxyXG4gICAgfSxcclxuICAgIHMzQnVja2V0OiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IFt0cnVlLCAnUzMgYnVja2V0IGlzIHJlcXVpcmVkJ10sXHJcbiAgICB9LFxyXG4gICAgczNLZXk6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogW3RydWUsICdTMyBrZXkgaXMgcmVxdWlyZWQnXSxcclxuICAgICAgdW5pcXVlOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIGNsb3VkZnJvbnRVcmw6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICByZXF1aXJlZDogW3RydWUsICdDbG91ZEZyb250IFVSTCBpcyByZXF1aXJlZCddLFxyXG4gICAgfSxcclxuICAgIHNpemVCeXRlczoge1xyXG4gICAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ0ZpbGUgc2l6ZSBpcyByZXF1aXJlZCddLFxyXG4gICAgfSxcclxuICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgIHdpZHRoOiBOdW1iZXIsXHJcbiAgICAgIGhlaWdodDogTnVtYmVyLFxyXG4gICAgICBmb3JtYXQ6IFN0cmluZyxcclxuICAgIH0sXHJcbiAgICBpc0RlbGV0ZWQ6IHtcclxuICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgZGVmYXVsdDogZmFsc2UsXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAge1xyXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcclxuICB9XHJcbik7XHJcblxyXG4vLyBJbmRleGVzIGZvciBlZmZpY2llbnQgcXVlcmllc1xyXG5hc3NldFNjaGVtYS5pbmRleCh7IG93bmVySWQ6IDEsIGlzRGVsZXRlZDogMSB9KTtcclxuYXNzZXRTY2hlbWEuaW5kZXgoeyBzM0tleTogMSB9KTtcclxuYXNzZXRTY2hlbWEuaW5kZXgoeyBjcmVhdGVkQXQ6IC0xIH0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IEFzc2V0ID0gbW9uZ29vc2UubW9kZWw8SUFzc2V0PignQXNzZXQnLCBhc3NldFNjaGVtYSk7XHJcbiJdfQ==